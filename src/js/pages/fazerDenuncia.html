<!DOCTYPE html>
<html lang="pt-BR" class="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Aquacife ‚Äî Nova Den√∫ncia</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

  <!-- Fontes / Icones -->
  <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;700;900&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>

  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            primary: "#1E90FF",
            accent: "#FFD700",
            "background-dark": "#101922",
            "background-light": "#f6f7f8"
          },
          fontFamily: { display: ["Public Sans", "sans-serif"] },
          borderRadius: { xl: "2rem", full: "9999px" }
        }
      }
    }
  </script>

  <style>
    body { font-family: 'Public Sans', sans-serif; }
    
    .page-bg {
      min-height: 100vh;
      background-image:
        linear-gradient(rgba(13,30,45,0.75), rgba(0,31,63,0.9)),
        url("https://lh3.googleusercontent.com/aida-public/AB6AXuA6lAUBk07Wpi0aWbUM9utneFcmBo15Y855EPZPgf-_ScYsXAcKlrBusQJTVH1CzfwHxqlM-X2SqIqSaeBFkRCingfWs8nzEOshHoO42WPfgafjg-LFLGOAdsMFiK81ibU7NxWntRhcSF4WqkLQo0mMgulxYe7x-bbsMQ7yrPW4tFHxCib5-qs-r_xJ6XIKyLEf4f9MrAAXzr_GsFrPNf0gqWuUjEjttYjf8cvHGBIxON6vcNObfS8pe-LwIVFWAJTw3rG5zi1AJ9vH");
      background-size: cover;
      background-position: center;
    }

    
    .glass-card {
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.08);
      backdrop-filter: blur(8px);
    }

    
    .preview-media img,
    .preview-media video {
      border-radius: 0.75rem;
      display:block;
      max-height:320px;
      width:100%;
      object-fit:cover;
    }

    
    .pin-hint {
      font-size: 0.9rem;
      color: rgba(229,231,235,0.95); /* slate-200 */
    }

    
    #confirmBox { display:none; }
  </style>
</head>
<body class="page-bg text-white">

  
  <header class="w-full flex items-center justify-between p-5 px-8">
    <div class="flex items-center gap-3">
      <span class="material-symbols-outlined text-4xl text-[#1E90FF]">water_drop</span>
      <h1 class="text-3xl font-black text-[#1E90FF]">Aquacife</h1>
    </div>

    <div class="flex items-center gap-4">
      <button id="btnBackMenu"
        class="px-4 py-2 bg-white/10 backdrop-blur-md rounded-full text-sm font-bold hover:bg-white/20 transition">
        <span class="material-symbols-outlined align-middle">arrow_back</span>
        <span class="ml-1 align-middle hidden sm:inline">Menu</span>
      </button>
    </div>
  </header>

  
  <main class="max-w-3xl mx-auto px-6 pb-20">
    <section class="glass-card rounded-2xl p-6 mt-8 shadow-lg">
      <h2 class="text-2xl font-bold text-white">Nova Den√∫ncia</h2>
      <p class="text-slate-200 mt-1 max-w-prose">Registre um problema relacionado a √°gua ou saneamento. Anexe fotos/v√≠deos e escolha o local no mapa.</p>

      
      <form id="denunciaForm" class="mt-6 space-y-4">

        
        <div>
          <label class="block text-sm font-semibold text-slate-100 mb-2">Tipo de den√∫ncia</label>
          <select id="tipo" required
            class="w-full rounded-xl p-3 bg-white/90 text-slate-800 border border-white/20 focus:outline-none focus:ring-2 focus:ring-[#1E90FF]">
            <option value="">-- Selecione --</option>
            <option>Vazamento</option>
            <option>Falta de √°gua</option>
            <option>Esgoto</option>
            <option>Outros</option>
          </select>
        </div>

        
        <div>
          <label class="block text-sm font-semibold text-slate-100 mb-2">Descri√ß√£o</label>
          <textarea id="descricao" required
            class="w-full rounded-xl p-3 bg-white/90 text-slate-800 border border-white/20 h-32 resize-none focus:outline-none focus:ring-2 focus:ring-[#1E90FF]"
            placeholder="Descreva o problema com detalhes (ex.: endere√ßo aproximado, ponto de refer√™ncia, quando come√ßou, etc.)"></textarea>
        </div>

        
        <div>
          <p class="text-sm font-semibold text-slate-100 mb-2">Anexar m√≠dia</p>

          
          <input id="fotoInput" type="file" accept="image/*" class="hidden" />
          <input id="videoInput" type="file" accept="video/*" class="hidden" />

          <div class="grid grid-cols-2 gap-3">
            <button type="button" id="btnFoto"
              class="w-full rounded-xl py-3 bg-accent text-primary font-bold hover:scale-[1.02] transition">
              üì∑ Anexar Foto
            </button>

            <button type="button" id="btnVideo"
              class="w-full rounded-xl py-3 bg-white/10 backdrop-blur-md text-white font-bold hover:bg-white/20 transition">
              üé• Anexar V√≠deo
            </button>
          </div>

          
          <div id="previewContainer" class="preview-media mt-4"></div>
        </div>

        
        <div>
          <div class="flex items-center justify-between">
            <label class="text-sm font-semibold text-slate-100 mb-2">Localiza√ß√£o (Recife)</label>
            <span id="coords" class="pin-hint">Lat: ‚Äî , Lng: ‚Äî</span>
          </div>

          <div class="glass-card rounded-xl overflow-hidden border border-white/10">
            
            <div id="map" class="w-full h-72"></div>
            <div class="p-3 border-t border-white/5">
              <p class="text-sm text-slate-200 mb-1">Arraste o pino no mapa para selecionar o local exato (toque e arraste em celular).</p>
              <div class="flex gap-3">
                <button id="btnMyLoc" type="button" class="px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 transition text-white text-sm">Usar minha localiza√ß√£o</button>
                <button id="btnResetPin" type="button" class="px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 transition text-white text-sm">Centralizar Recife</button>
              </div>
            </div>
          </div>
        </div>

        
        <div class="flex flex-col gap-3 mt-2">
          <button id="btnEnviar" type="button"
            class="w-full rounded-xl py-4 bg-[#1E90FF] text-white font-bold text-lg hover:brightness-95 transition">Enviar Den√∫ncia</button>

          <div id="formError" class="text-sm text-red-300 text-center hidden">Preencha os campos obrigat√≥rios.</div>
        </div>
      </form>
    </section>

    
    <section class="mt-8">
      <div class="glass-card rounded-2xl p-6 mt-2 shadow-lg">
        <h3 class="text-lg font-bold text-accent">Novidades</h3>
        <p class="text-slate-200 mt-2">Estamos trabalhando em integra√ß√£o com √≥rg√£os p√∫blicos e notifica√ß√µes inteligentes. Em breve haver√° hist√≥rico de den√∫ncias e acompanhamento em tempo real.</p>
      </div>
    </section>

    
    <footer class="mt-8 text-center text-slate-300 text-sm">
      ¬© 2025 Aquacife. Todos os direitos reservados.
    </footer>
  </main>

  
  <div id="confirmBox" class="fixed inset-0 flex items-center justify-center bg-black/60 backdrop-blur-sm" style="display:none;">
    <div class="bg-white rounded-2xl p-6 max-w-sm w-full text-center">
      <h4 class="text-xl font-bold text-slate-900">Den√∫ncia enviada!</h4>
      <p class="text-slate-700 mt-2">Recebemos sua den√∫ncia com sucesso. Obrigado por contribuir com o cuidado da cidade.</p>
      <div class="mt-4 flex gap-3">
        <button id="confirmOk" class="flex-1 py-2 rounded-lg bg-[#1E90FF] text-white font-bold">Ok</button>
        <button id="confirmMenu" class="flex-1 py-2 rounded-lg bg-white/10 text-white">Voltar ao Menu</button>
      </div>
    </div>
  </div>

  
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAFRJIkFsPpicXLiBqTVYO0cutHRxeI2cY&callback=__initMap" async defer></script>

  <script>
  
    let map, marker;
    const recife = { lat: -8.05428, lng: -34.8813 };

    
    function __initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        center: recife,
        zoom: 14,
        disableDefaultUI: true,
        gestureHandling: 'greedy'
      });

      marker = new google.maps.Marker({
        position: recife,
        map,
        draggable: true,
        title: 'Arraste para selecionar o local'
      });

      updateCoords(marker.getPosition());
      marker.addListener('dragend', () => updateCoords(marker.getPosition()));
      marker.addListener('position_changed', () => updateCoords(marker.getPosition()));
    }

    function updateCoords(pos) {
      const lat = pos.lat().toFixed(6);
      const lng = pos.lng().toFixed(6);
      document.getElementById('coords').textContent = `Lat: ${lat} , Lng: ${lng}`;
    }

    
    function centerRecife() {
      map.setCenter(recife);
      marker.setPosition(recife);
      map.setZoom(14);
    }

    
    document.getElementById('btnMyLoc').addEventListener('click', () => {
      if (!navigator.geolocation) return alert('Geolocaliza√ß√£o n√£o suportada neste navegador.');
      navigator.geolocation.getCurrentPosition((pos) => {
        const p = { lat: pos.coords.latitude, lng: pos.coords.longitude };
        map.setCenter(p);
        marker.setPosition(p);
        map.setZoom(16);
      }, (err) => {
        alert('N√£o foi poss√≠vel obter a localiza√ß√£o. Verifique permiss√µes.');
      }, { enableHighAccuracy: true });
    });

    document.getElementById('btnResetPin').addEventListener('click', centerRecife);

    
    const fotoInput = document.getElementById('fotoInput');
    const videoInput = document.getElementById('videoInput');
    const previewContainer = document.getElementById('previewContainer');

    document.getElementById('btnFoto').addEventListener('click', () => fotoInput.click());
    document.getElementById('btnVideo').addEventListener('click', () => videoInput.click());

    function clearPreview() {
      previewContainer.innerHTML = '';
    }

    function showPreview(file) {
      clearPreview();
      if (!file) return;
      const type = file.type;
      if (type.startsWith('image/')) {
        const img = document.createElement('img');
        img.src = URL.createObjectURL(file);
        img.alt = 'Pr√©-visualiza√ß√£o';
        img.className = 'rounded-xl shadow';
        previewContainer.appendChild(img);
      } else if (type.startsWith('video/')) {
        const vid = document.createElement('video');
        vid.src = URL.createObjectURL(file);
        vid.controls = true;
        vid.className = 'rounded-xl shadow';
        previewContainer.appendChild(vid);
      }
    }

    fotoInput.addEventListener('change', (e) => {
      const f = e.target.files[0];
      showPreview(f);
    });

    videoInput.addEventListener('change', (e) => {
      const f = e.target.files[0];
      showPreview(f);
    });

    
    const form = document.getElementById('denunciaForm');
    const btnEnviar = document.getElementById('btnEnviar');
    const formError = document.getElementById('formError');
    const confirmBox = document.getElementById('confirmBox');

    btnEnviar.addEventListener('click', () => {
      
      const tipo = document.getElementById('tipo').value.trim();
      const desc = document.getElementById('descricao').value.trim();
      if (!tipo || !desc) {
        formError.classList.remove('hidden');
        return;
      }
      formError.classList.add('hidden');

    
      const data = {
        tipo,
        descricao: desc,
        coords: document.getElementById('coords').textContent,
        timestamp: new Date().toISOString()
      };

      
      console.log('Enviando den√∫ncia (simulada):', data);

      
      confirmBox.style.display = 'flex';
    });

    
    document.getElementById('confirmOk').addEventListener('click', () => {
      confirmBox.style.display = 'none';
      
      form.reset();
      clearPreview();
      centerRecife();
      document.getElementById('coords').textContent = 'Lat: ‚Äî , Lng: ‚Äî';
    });

    document.getElementById('confirmMenu').addEventListener('click', () => {
      
      window.location.href = 'menu.html';
    });

    
    document.getElementById('btnBackMenu').addEventListener('click', () => {
      window.location.href = 'menu.html';
    });

    
    window.addEventListener('load', () => {
      
      setTimeout(() => {
        if (typeof google === 'undefined') {
          const mapEl = document.getElementById('map');
          mapEl.innerHTML = '<div class="flex items-center justify-center h-full text-slate-300">Mapa indispon√≠vel. Verifique sua API Key e conex√£o.</div>';
        }
      }, 1800);
    });
  </script>
</body>
</html>
